# Maze Agent Integration実験設計書

## 実験概要

MainAgentを活用して迷路解法を行い、リアルタイムで探索過程と知識グラフの成長を可視化する実験。成功したらLayer5（Visualization Layer）として本実装に統合することを見据えた設計。

## 実験目的

1. **Wake Modeの効果検証**
   - geDIG最小化による効率的な迷路探索
   - 既存パターンの再利用

2. **5次元ベクトルの実証**
   - 迷路タスクでの有効性確認
   - メモリ効率の測定（1/77削減）

3. **知識グラフの可視化**
   - エピソードグラフの成長過程
   - geDIG値の変化を視覚的に理解

4. **エージェント専門化の検証**
   - MazeAgent構想の実現可能性
   - MainAgentからの分離の妥当性

## 実験設計

### 入力
```python
maze_query = {
    "type": "maze",
    "maze": [
        [0, 0, 1, 0, 0],  # 0: 通路, 1: 壁
        [0, 1, 1, 0, 0],  # S: スタート
        [0, 0, 0, 0, 1],  # G: ゴール
        [1, 0, 1, 0, 0],
        [0, 0, 0, 0, 0]
    ],
    "start": (0, 0),
    "goal": (4, 4)
}
```

### 処理フロー
1. MainAgentのラッパーとしてMazeAgentWrapperを作成
2. 迷路クエリを受け取ったら自動探索モードに切り替え
3. 各ステップで：
   - 現在位置から次の行動を決定（Wake Mode）
   - 行動実行と結果の記録
   - 知識グラフの更新
   - ビジュアライゼーションの更新

### 出力
- 迷路解法のアニメーション（GIF）
- 知識グラフの成長過程
- パフォーマンスメトリクス

## 実装アーキテクチャ

### コンポーネント構成
```
MazeAgentWrapper
├─ MainAgentインスタンス（既存コード活用）
├─ MazeEnvironment（迷路管理）
├─ VectorAdapter（384次元→5次元変換）
└─ Visualizer（matplotlib/networkx）
```

### クラス設計
```python
class MazeAgentWrapper:
    """MainAgentを迷路タスク用にラップ"""
    def __init__(self, config):
        self.main_agent = MainAgent(config, datastore)
        self.vector_adapter = CompactVectorAdapter()
        self.visualizer = MazeVisualizer()
        
    def solve_maze(self, maze_query):
        # Wake Mode固定
        # 5次元ベクトルで処理
        # ビジュアライゼーション付き
```

## 評価基準

### 定量的評価
1. **探索効率**
   - ステップ数
   - 訪問重複率
   - 最短経路からの乖離

2. **計算効率**
   - 処理時間
   - メモリ使用量
   - ベクトル次元削減効果

3. **学習効果**
   - パターン再利用率
   - geDIG値の収束速度

### 定性的評価
1. **可視化の有効性**
   - 探索戦略の理解しやすさ
   - 知識グラフの解釈性

2. **統合の容易さ**
   - MainAgentの改変不要性
   - 拡張性の確認

## リスクと対策

### リスク1: MainAgentとの不整合
**対策**: アダプターパターンで差異を吸収

### リスク2: パフォーマンス劣化
**対策**: プロファイリングとボトルネック特定

### リスク3: 可視化の複雑化
**対策**: シンプルな2パネル構成を維持

## 成功基準

1. MainAgentを改変せずに迷路を解ける
2. 5次元ベクトルで効率的に動作
3. リアルタイムビジュアライゼーションが機能
4. 将来的なLayer5統合への道筋が見える

## 実験スケジュール

### Day 1: 基本実装
- MazeAgentWrapperの骨組み
- MainAgentとの接続
- 基本的な迷路解法

### Day 2: ビジュアライゼーション
- 2パネル表示の実装
- アニメーション機能
- geDIG値の可視化

### Day 3: 最適化と評価
- 5次元ベクトル最適化
- パフォーマンス測定
- 結果の分析とレポート作成

## 次のステップ

1. MazeAgentWrapperの実装開始
2. 簡単な5×5迷路でのテスト
3. ビジュアライゼーションのプロトタイプ作成