# エピソード記憶とメッセージパッシング統合実験 V2

## 実験目的

迷路探索タスクにおいて、シンプルなエピソード記憶と一貫したクエリによるgeDIGアルゴリズムの効果を検証する。

## 実験設計（簡潔版）

### 1. エピソード記憶の構造（2種類のみ）

#### タイプ1: ゴール情報エピソード
```
{
    type: "goal_info",
    content: "ゴール位置は(9, 9)",
    vector: [ゴール情報のベクトル表現]
}
```

#### タイプ2: 移動エピソード
```
{
    type: "movement",
    from: (x1, y1),
    to: (x2, y2),
    action: "上/右/下/左",
    result: "成功/壁/行き止まり",
    vector: [移動エピソードのベクトル表現]
}
```

### 2. 単一クエリの構造

**常に同じクエリ**:
```
"ゴールに辿り着くために、現在位置(x, y)で次に移動すべき方向は？"
```

### 3. 処理フロー

```
1. 初期化
   - ゴール情報エピソードを記憶に追加
   - 現在位置 = スタート位置

2. メインループ（ゴール到達まで）:
   a. クエリ生成
      「ゴールに辿り着くために、現在位置(x, y)で次に移動すべき方向は？」
   
   b. 類似度探索
      - エピソード記憶から類似エピソードを検索
      - geDIGアルゴリズムで最適な行動を決定
   
   c. 行動実行
      - 決定した方向に移動を試みる
   
   d. エピソード形成
      - 移動結果（成功/壁/行き止まり）を記録
      - 新しい移動エピソードを記憶に追加
   
   e. 次のクエリへ
      - 新しい現在位置でループ継続
```

### 4. メッセージパッシングの仕組み

**行き止まり到達時**:
- 経路上の全ての位置に「この方向は行き止まり」情報を伝播
- 関連する移動エピソードの価値を更新

**ゴール到達時**:
- 経路上の全ての位置に「この方向はゴールへ通じる」情報を伝播
- 関連する移動エピソードの価値を更新

### 5. 類似度探索の詳細

クエリベクトルと各エピソードベクトルの類似度を計算:
- 現在位置の近さ
- 移動結果の価値（成功 > 未探索 > 壁 > 行き止まり）
- メッセージパッシングによる価値更新

### 6. ビジュアライゼーション

#### 6.1 迷路とエージェント（左側）
- 現在のエージェント位置
- 訪問済み位置（薄い青）
- 行き止まり（赤×）
- 分岐点（青○）

#### 6.2 エピソード記憶グラフ（右側）
- ゴール情報ノード（黄色）
- 移動エピソード（矢印）
  - 成功移動（青矢印）
  - 壁衝突（赤矢印）
  - 行き止まり到達（赤太矢印）
- メッセージパッシング（点線）

### 7. 実装の単純化

1. **クエリは常に同じ形式**
   - パラメータは現在位置のみ変化

2. **エピソード記憶は2種類のみ**
   - ゴール情報
   - 移動結果

3. **決定論的な動作**
   - 類似度最大のエピソードに従う
   - ランダム要素は未探索時のみ

### 8. 評価指標

1. **シンプルさ**
   - コードの行数
   - アルゴリズムの明快さ

2. **効率性**
   - ゴール到達までのステップ数
   - 同じミスの回避

3. **説明可能性**
   - なぜその行動を選んだか追跡可能
   - エピソード記憶の可視化

## 期待される成果

1. **極めてシンプルな実装**
   - 理解しやすい
   - デバッグしやすい
   - 拡張しやすい

2. **効率的な探索**
   - 行き止まり情報の即座の活用
   - 成功経路の再利用

3. **geDIGの本質的な動作の可視化**
   - 類似度に基づく意思決定
   - 経験の蓄積と活用