# Question-Answer Experiment Design (Updated)

## 実験の背景と動機

InsightSpike-AIは、単なる情報検索を超えて「洞察（インサイト）」を生成することを目指しています。この実験では、論文に記載された質問応答タスクを基に、500の前提知識と100の難易度別質問を用いて、システムがどのように既存の知識を組み合わせて新しい洞察を生み出すかを検証します。

## 研究課題

### 主要研究課題
1. **RQ1**: InsightSpikeは従来の検索ベース手法と比較して、より創造的で洞察に富んだ回答を生成できるか？
2. **RQ2**: どのような種類の質問がスパイク（洞察の瞬間）を誘発しやすいか？
3. **RQ3**: 知識ベースのサイズと質が、洞察生成能力にどのように影響するか？

### 副次的研究課題
- スパイクの発生と回答品質の相関関係
- 処理時間とメモリ使用量のトレードオフ
- クエリ保存機能による学習効果の検証

## 実験設計の詳細

### 1. 前提知識設計（500件）

#### ジャンル別構成とタグ
1. **科学・技術** (100件, 20%)
   - タグ: `science`, `physics`, `chemistry`, `biology`, `technology`
   - 例: 物理法則、化学反応、生物学的プロセス、技術原理

2. **数学・論理** (75件, 15%)
   - タグ: `mathematics`, `logic`, `statistics`, `algorithm`
   - 例: 数学的概念、論理的推論、統計原理、アルゴリズム

3. **歴史・文化** (75件, 15%)
   - タグ: `history`, `culture`, `society`, `tradition`
   - 例: 歴史的事実、文化的慣習、社会現象

4. **日常生活** (75件, 15%)
   - タグ: `daily_life`, `cooking`, `health`, `sports`
   - 例: 料理知識、健康情報、スポーツ技術

5. **芸術・文学** (75件, 15%)
   - タグ: `art`, `literature`, `music`, `creativity`
   - 例: 芸術理論、文学概念、音楽知識

6. **哲学・心理学** (50件, 10%)
   - タグ: `philosophy`, `psychology`, `cognition`, `ethics`
   - 例: 哲学的概念、心理学理論、認知科学

7. **経済・ビジネス** (50件, 10%)
   - タグ: `economics`, `business`, `finance`, `management`
   - 例: 経済原理、ビジネス戦略、金融知識

#### 知識エントリー構造
```json
{
  "id": "knowledge_001",
  "content": "知識の内容",
  "tags": ["science", "physics"],
  "difficulty": "basic",
  "related_concepts": ["concept1", "concept2"]
}

### 2. 質問設計（100件）

#### 難易度別構成
1. **Easy (30問)** - 単一知識の直接参照
   - 事実確認、定義説明
   - 期待: 洞察なし、高速回答

2. **Medium (40問)** - 2-3知識の統合
   - 関連性の説明、比較分析
   - 期待: 低確率の洞察、分岐可能性

3. **Hard (20問)** - 複数知識の創造的統合
   - 類推、新概念の提案
   - 期待: 高確率の洞察生成

4. **Very Hard (10問)** - 異分野知識の革新的結合
   - パラダイムシフト的な質問
   - 期待: 高品質な洞察、複数分岐

#### 質問エントリー構造
```json
{
  "id": "question_001",
  "question": "質問文",
  "difficulty": "medium",
  "expected_tags": ["science", "philosophy"],
  "insight_potential": "high",
  "evaluation_criteria": {
    "accuracy": true,
    "creativity": true,
    "depth": true
  }
}

### 3. 実験データ収集

#### 収集データ項目
```json
{
  "question_id": "question_001",
  "question": "質問文",
  "has_insight": true,
  "has_branching": false,
  "insight_episode_vector": [0.123, -0.456, ...],  // 384次元
  "branching_episode_vector": null,
  "llm_prompt": "実際にLLMに送信されたプロンプト",
  "llm_response": "LLMからの回答",
  "llm_response_vector": [0.789, -0.012, ...],  // 384次元
  "insight_similarity": 0.85,  // 洞察エピソードとの類似度
  "processing_time": 2.34,  // 秒
  "timestamp": "2025-01-28T10:30:00Z",
  "metadata": {
    "cycles": 3,
    "retrieved_episodes": 5,
    "graph_nodes": 12
  }
}
```

#### add_knowledge時の洞察記録
```json
{
  "knowledge_id": "knowledge_001", 
  "content": "追加された知識",
  "has_insight": true,
  "insight_content": "生成された洞察",
  "insight_vector": [0.234, -0.567, ...],
  "processing_time": 0.89,
  "timestamp": "2025-01-28T10:25:00Z"
}
```

### 4. 実験手順

#### Phase 1: データ準備
1. 500件の前提知識データ作成（ジャンル別タグ付き）
2. 100件の質問データ作成（難易度別）
3. Claude 3.5 Sonnet APIの設定確認

#### Phase 2: 知識ベース構築
1. `add_knowledge`コマンドで500件の知識を順次追加
2. 知識追加時の洞察発生を記録
3. 知識グラフの成長過程を保存

#### Phase 3: 質問応答実験
1. `adaptive_loop`を使用して100件の質問を処理
2. 各質問の詳細データを収集
3. JSON/CSV両形式でリアルタイム保存

#### Phase 4: データ分析とビジュアライゼーション
1. 難易度別の洞察発生率分析
2. ジャンル間の知識結合パターン解析
3. 処理時間と洞察品質の相関分析
4. 最適なビジュアライゼーション手法の選定と実装

## 仮説

### H1: 創造的優位性
InsightSpikeは創造的質問において、ベースラインよりも有意に高い評価を得る。

### H2: スパイク相関
スパイクが発生した質問は、より高品質な回答を生成する。

### H3: 知識ベース効果
中規模（500エントリ）の知識ベースが、洞察生成において最適なバランスを示す。

## 実験環境と設定

### LLMプロバイダー
- **使用モデル**: Claude 3.5 Sonnet (anthropic)
- **温度設定**: 0.7
- **最大トークン**: 1000

### 実験環境
- **DataStore**: FileSystemDataStore（永続化必須）
- **Memory**: CachedMemoryManager使用
- **Graph**: NetworkXベース、メッセージパッシング有効
- **Vector次元**: 384次元（Sentence-BERT）

### データ保存形式
- **JSON形式**: 詳細データ、ベクトル値含む
- **CSV形式**: 分析用集計データ
- **スナップショット**: 実験終了時の完全バックアップ

## 期待される成果と影響

### 学術的貢献
- 洞察生成メカニズムの理解
- 知識統合における新しいアプローチ
- 認知科学への示唆

### 実用的価値
- より創造的なAIアシスタントの開発
- 教育・研究支援ツールへの応用
- 知識発見システムの改善

## ビジュアライゼーション計画

### 基本的な可視化
1. **洞察発生率ヒートマップ**
   - X軸: 質問難易度
   - Y軸: 知識ジャンルの組み合わせ
   - 色: 洞察発生率

2. **処理時間分布**
   - 難易度別ボックスプロット
   - 洞察有無での比較

3. **知識グラフの成長**
   - ノード数とエッジ数の時系列変化
   - 洞察発生時のグラフ構造変化

### 高度な分析
1. **ベクトル空間分析**
   - t-SNEによる洞察エピソードの可視化
   - 質問-回答-洞察の類似度マップ

2. **ジャンル間相互作用**
   - サンキーダイアグラムで知識結合パターン表示
   - ネットワーク図で洞察生成の知識フロー

3. **パフォーマンス分析**
   - 並列座標プロットで多次元メトリクス表示
   - ROC曲線で洞察予測精度評価

---

*更新日: 2025-01-28*