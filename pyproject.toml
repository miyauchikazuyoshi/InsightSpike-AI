[tool.poetry]
name = "insightspike-ai"
version = "0.7.0"
description = "InsightSpike prototype with PyG-based GNN layers"
authors = ["YOUR NAME <you@example.com>"]
packages = [{ include = "insightspike", from = "src" }]

[tool.poetry.dependencies]
python = "^3.11"
# Environment-specific packages excluded from Poetry:
# - torch (installed via pip with environment-specific versions)
# - numpy (version conflicts: local 1.x vs Colab 1.x, managed by setup scripts)
# - faiss (GPU vs CPU variants)
numpy = ">=1.24.0,<2.0.0"  # Unified NumPy 1.x for FAISS compatibility
sentence-transformers = "^2.5"
scipy = "^1.12"
transformers = "<4.40"
accelerate = "^0.29"
networkx = "^3.3"
typer = ">=0.7,<0.10"
click = ">=8.0,<8.2"
rich = "^13.6"
datasets = "^2.5"
scikit-learn = "^1.4"
matplotlib = "^3.8"
nltk = "^3.8"
pyyaml = "^6.0"
spacy = ">=3.7.0,<3.8.0"  # Compatible with thinc 8.2.x
thinc = ">=8.2.0,<8.3.0"  # NumPy 1.x compatible version

[tool.poetry.group.dev.dependencies]
pytest = "^8.0"
pytest-cov = "^4.0"
black = "^23.0"
isort = "^5.0"
flake8 = "^6.0"
faiss-cpu = "^1.11"  # CPU版faiss（ローカル開発用）

[tool.poetry.group.local.dependencies]
# ローカル開発環境用 - setup.shで個別インストール
# torch, numpy, faiss, torch-geometricは環境依存のためsetup.shで処理

[tool.poetry.group.ci.dependencies]
pytest = "^8.0"
# CIでは faiss は手動インストール（LITE_MODE使用）

[tool.poetry.group.colab.dependencies]
# Colab環境では、以下はsetup_colab.shで先行インストール:
# - torch>=2.4.0 (with CUDA 12.1)
# - numpy==1.26.4 (FAISS + thinc compatible)
# - faiss-gpu-cu12==1.11.0
# - torch-geometric (optional)
ipywidgets = "^8.0"  # Jupyter widget support for Colab

[tool.poetry.scripts]
insightspike = "insightspike.cli:app"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"